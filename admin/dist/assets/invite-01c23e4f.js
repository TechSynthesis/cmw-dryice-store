import{a8 as C,r as S,c$ as q,u as k,j as r,a as e,B as m}from"./index-57d81519.js";import{q as I}from"./index-e3b6f852.js";import{c as E,g as L,I as l,u as P}from"./index-71f8d57a.js";import{d as F}from"./index.modern-8e6f78ab.js";import{P as d,S as n}from"./login-layout-baf329c5.js";import{S as u}from"./index-b2c6ca56.js";import{F as c}from"./index-5a412697.js";const V=()=>{const p=C(),t=I.parse(p.search.substring(1)),[h,g]=S.useState(!1);let o=null;if(t!=null&&t.token)try{o=F(t.token)}catch{o=null}const{register:s,handleSubmit:f,formState:{errors:i},setError:x}=E({defaultValues:{first_name:"",last_name:"",password:"",repeat_password:""}}),{mutate:w,isLoading:v}=q(),y=k(),_=P(),N=f(a=>{if(a.password!==a.repeat_password){x("repeat_password",{type:"manual",message:"Passwords do not match"},{shouldFocus:!0});return}w({token:t.token,user:{first_name:a.first_name,last_name:a.last_name,password:a.password}},{onSuccess:()=>{y("/login")},onError:b=>{_("Error",L(b),"error")}})});return o?r(d,{children:[e(u,{title:"Create Account"}),h?e("form",{onSubmit:N,children:r("div",{className:"flex flex-col items-center",children:[e("h1",{className:"inter-xlarge-semibold mb-large text-[20px]",children:"Create your TechInverted eCommerce account"}),r("div",{className:"gap-y-small flex flex-col",children:[r("div",{children:[e(n,{placeholder:"First name",...s("first_name",{required:c.required("First name")}),autoComplete:"given-name"}),e(l,{errors:i,name:"first_name"})]}),r("div",{children:[e(n,{placeholder:"Last name",...s("last_name",{required:c.required("Last name")}),autoComplete:"family-name"}),e(l,{errors:i,name:"last_name"})]}),e("div",{children:e(n,{placeholder:"Password",type:"password",...s("password",{required:c.required("Password")}),autoComplete:"new-password"})}),r("div",{children:[e(n,{placeholder:"Confirm password",type:"password",...s("repeat_password",{required:"You must confirm your password"}),autoComplete:"new-password"}),e(l,{errors:i,name:"repeat_password"})]})]}),e(m,{variant:"secondary",size:"medium",className:"mt-large w-[280px]",loading:v,children:"Create account"}),r("p",{className:"inter-small-regular text-grey-50 mt-xlarge",children:["Already signed up? ",e("a",{href:"/login",children:"Log in"})]})]})}):r("div",{className:"flex flex-col items-center text-center",children:[e("h1",{className:"inter-xlarge-semibold text-[20px]",children:"You have been invited to join the team"}),r("p",{className:"inter-base-regular text-grey-50 mt-xsmall",children:["You can now join the team. Sign up below and get started",e("br",{}),"with your TechInverted eCommerce account right away."]}),e(m,{variant:"secondary",size:"medium",className:"mt-xlarge w-[280px]",onClick:()=>g(!0),children:"Sign up"})]})]}):r(d,{children:[e(u,{title:"Create Account"}),r("div",{className:"gap-y-xsmall flex flex-col items-center",children:[e("h1",{className:"inter-xlarge-semibold mb- text-[20px]",children:"Invalid invite"}),e("p",{className:"inter-base-regular text-grey-50 w-[280px] text-center",children:"The invite link you have used is invalid. Please contact your administrator."}),r("p",{className:"inter-small-regular text-grey-40 mt-xlarge",children:["Already have an account? ",e("a",{href:"/login",children:"Log in"})]})]})]})};export{V as default};
